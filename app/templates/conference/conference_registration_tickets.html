{% extends "base.html" %}
{% set active_page = "conferenceRegistration" %}
{% set active_subpage = "registration_tickets" %}
{% if endpoint == 'registration_tickets' %}
{% set url = url_for('conference.registration_tickets', conference_id=conference.id) %}
{% set page_title = "Tickets" %}
{% elif endpoint == 'registration_promo_code' %}
{% set page_title = "Promo Code" %}
{% set url = url_for('conference.registration_promo_code', conference_id=conference.id) %}
{% else %}
{% set page_title = "Products" %}
{% set url = url_for('conference.registration_products', conference_id=conference.id) %}
{% endif %}


{% block page_heading %}
    {{ macros.breadcrumb_widget([('Home', url_for('main.dashboard')), ('Registration', '#'), (page_title, url)]) }}
{% endblock %}

{% block head %}
    {{ super() }}
    <!-- datepicker -->
    <link href="{{ url_for('static', filename='conferency/css/datepicker3.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='inspinia/css/plugins/switchery/switchery.css') }}" rel="stylesheet">
    <style>
        .center {
            float: none;
            margin-left: auto;
            margin-right: auto;
        }

        img {
            max-width: 100%;
            max-height: 100%;
        }

        .add-ticket-button-control {
            margin-top: 20px;
            margin-bottom: 20px;
            padding-left: 15px;
        }

        .margin-control {
            margin-top: 15px;
        }

        .padding-control {
            padding-bottom: 5px;
        }

        .left-padding-15 {
            padding-left: 15px !important;
        }

        .bottom-padding-control {
            padding-bottom: 25px;
        }

        .button-align-padding {
            padding-top: 3px;
        }

        .span-align-padding {
            padding: 7px 0px;
        }

        @media (max-width: 768px) {
            .span-align-padding {
                padding: 7px 0px;
                display: none;
            }
        }

        @media (min-width: 1050px) {
            .para-button-align {
                display: inline-block;
                margin-bottom: 0px;
            }

            .button-para-align {
                position: relative;
                top: -25px;
            }
        }

        @media (max-width: 1050px) {
            .para-button-align {
                display: block;
            }

            .button-para-align {
                display: inline-block;
            }

            .div-button-align {
                display: table;
                padding-right: 15px;
                padding-left: 15px;
            }
        }

        .margin-button-5 {
            margin-bottom: 5px;
        }

        .margin-top-6 {
            margin-top: 6px !important;
        }

        .promo-code {
            font-size: 14px;
            color: #676a6c;
            font-weight: 600;
        }

        .wizard .content {
            min-height: 100px;
        }

        .wizard .content > .body {
            width: 100%;
            height: auto;
            position: relative;
        }

        /*label break*/
        /* label {
            word-break: break-word;
        } */

        .m-t-2 {
            margin-top: 2px;
        }

        input[disabled] {
            background-color: #eee;
            opacity: 1;
        }

        .input-group.error {
            border: 1px dotted #cc5965;
        }

        .currency {
            border: 0;
            outline: 1px solid #e5e6e7;
            outline-offset: -1px
        }

        .control-label {
            padding-top: 0px !important;
            margin-bottom: 5px !important;
            text-align: left !important;
        }

        .panel-heading h5 {
            display: inline-block;
            font-size: 14px;
            margin: 10px 0 7px;
            padding: 0;
            text-overflow: ellipsis;
            float: left;
        }

        .padding-bottom-5 {
            padding-bottom: 5px;
        }

        @media (min-width: 1050px) {
            .para-button-align {
                display: inline-block; margin-bottom:0px;
            }
            .button-para-align {
                position:relative;top: -25px;
            }
        }
        @media (max-width: 1050px) {
            .para-button-align {
                display: block;
            }
            .button-para-align {
                display: inline-block;
            }
            .div-button-align {
                display: table;
                padding-right: 15px;
                padding-left: 15px;
            }
        }
    </style>

{% endblock %}

{% block page_content %}
    {% set currency_list = ["USD", "CNY", "EUR", "GBP", "JPY"] %}
<div class="wrapper animated fadeInRight">
    <div id="registration_tickets">
        <div class="row form-horizontal">
            <div class="tabs-container">
                <ul class="nav nav-tabs">
                    {% if endpoint == 'registration_tickets' %}
                    <li class="active"><a href="#"><h3>Tickets</h3></a></li>
                    <li class="">
                        <a href="{{ url_for('conference.registration_products', conference_id=conference.id) }}">
                            <h3>Products</h3>
                        </a>
                    </li>
                    <li class="">
                        <a href="{{ url_for('conference.registration_promo_code', conference_id=conference.id) }}">
                            <h3>Promo Codes</h3>
                        </a>
                    </li>
                    {% elif endpoint == 'registration_products' %}
                    <li class="">
                        <a href="{{ url_for('conference.registration_tickets', conference_id=conference.id) }}">
                            <h3>Tickets</h3>
                        </a>
                    </li>
                    <li class="active"><a href="#"><h3>Products</h3></a></li>
                    <li class="">
                        <a href="{{ url_for('conference.registration_promo_code', conference_id=conference.id) }}">
                            <h3>Promo Codes</h3>
                        </a>
                    </li>
                    {% else %}
                    <li class="">
                        <a href="{{ url_for('conference.registration_tickets', conference_id=conference.id) }}">
                            <h3>Tickets</h3>
                        </a>
                    </li>
                    <li class="">
                        <a href="{{ url_for('conference.registration_products', conference_id=conference.id) }}">
                            <h3>Products</h3>
                        </a>
                    </li>
                    <li class="active"><a href="#"><h3>Promo Codes</h3></a></li>
                    {% endif %}
                    <li class="pull-right">
                        <input class="btn btn-primary" type="button" onclick="window.open('{{ url_for('main.registration_preview', conf_name=conference.short_name) }}')" value="Preview" />
                    </li>
                </ul>
                <div class="tab-content">
                    <div id="tickets" class="tab-pane {% if endpoint == 'registration_tickets' %}active{% endif %}">
                        <div class="panel-body">
                            <div id="ticket-info">
                                <form action="" id="setRegistration">
                                    <div class="ibox">
                                        <p class="text-info">The price of tickets with sales cannot be changed - create new tickets and hide existing ones if needed.</p>
                                        <div class="hr-line-dashed"></div>
                                        <div id="ticket-container">
                                            <div class="form-group">
                                                <div class="row col-sm-10 col-md-offset-1">
                                                    <div class="col-md-9 padding-control">
                                                        <label>Ticket name</label>
                                                    </div>
                                                </div>
                                            </div>
                                            {% set tickets = conference.registration.tickets.all() | rejectattr('status', 'equalto', 'Deleted') | list %}
                                            {% for ticket in tickets %}
                                                <div class="form-group origin-ticket ticket_group" id="ticket_{{ loop.index }}">
                                                    <div class="row col-sm-10 col-md-offset-1">
                                                        <div class="col-md-9 padding-control">
                                                            <input class="form-control required ticket-title"
                                                                   name="ticket_title_{{ loop.index }}"
                                                                   data-ticket-id="{{ ticket.id }}"
                                                                   placeholder="Ticket title" type="text"
                                                                   value="{{ ticket.name }}" aria-required="true">
                                                        </div>
                                                        <div class="col-md-1 button-align-padding">
                                                            <button class="btn btn-default btn-circle" type="button"
                                                                    data-ticket-id="{{ ticket.id }}"
                                                                    data-toggle="collapse"
                                                                    data-target="#ticket_collapse_{{ loop.index }}"><i
                                                                    class="fa fa-gear"></i></button>
                                                        </div>
                                                        <div class="col-md-1 button-align-padding">
                                                            {% if ticket.status == 'Hided' %}
                                                                <button class="btn btn-default btn-circle status conceal"
                                                                        type="button" data-ticket-id="{{ ticket.id }}">
                                                                    <i class="fa fa-eye-slash"></i></button>
                                                            {% else %}
                                                                <button class="btn btn-default btn-circle status unconceal"
                                                                        type="button" data-ticket-id="{{ ticket.id }}">
                                                                    <i class="fa fa-eye"></i></button>
                                                            {% endif %}
                                                        </div>
                                                        <div class="col-md-1 button-align-padding">
                                                            <!-- for delete icon -->
                                                            <button class="btn btn-default btn-circle btn-outline remove"
                                                                    type="button" data-ticket-id="{{ ticket.id }}"
                                                                    {% if ticket.ticket_transactions.all() | length > 0 %}disabled
                                                                    title="Titles have been sold"{% endif %}><i
                                                                    class="fa fa-trash"></i></button>
                                                        </div>
                                                        <div id="ticket_collapse_{{ loop.index }}"
                                                             class="collapse col-md-12">
                                                            <div style="padding: 15px 20px 20px 20px">
                                                                <div class="form-group">
                                                                    <div class="col-md-3 control-label">
                                                                        <p>Start date and end date</p>
                                                                    </div>
                                                                    <div class="col-md-7 col-md-offset-2">
                                                                        <div class="input-daterange input-group col-md-7"
                                                                             style="width: 100%;">
                                                                            <input type="text"
                                                                                   class="input-sm form-control required"
                                                                                   name="start"
                                                                                   value="{{ ticket.start_date|date }}" title="Ticket start date">
                                                                            <span class="input-group-addon control-height">to</span>
                                                                            <input type="text"
                                                                                   class="input-sm form-control required"
                                                                                   name="end"
                                                                                   value="{{ ticket.end_date|date }}" title="Ticket end date">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                {% for price in ticket.prices %}
                                                                    <div class="form-group">
                                                                        {% if loop.index0 == 0 %}
                                                                            <div class="col-md-3 control-label">
                                                                                <p>Price</p>
                                                                            </div>
                                                                        {% endif %}
                                                                        <div class="col-md-6 col-md-offset-{% if loop.index0 %}5{% else %}2{% endif %}">
                                                                            <div class="input-group price_group">
                                                                                <div class="input-group-btn">
                                                                                    <select class="form-control currency"
                                                                                            style="width: 100px;">
                                                                                        {% for currency in currency_list %}
                                                                                            <option value="{{ currency }}"
                                                                                                    {% if price.currency == currency %}selected{% endif %}>{{ currency }}</option>
                                                                                        {% endfor %}
                                                                                    </select>
                                                                                </div>
                                                                                <input type="number"
                                                                                       class="form-control required"
                                                                                       name="price"
                                                                                       value="{{ price.amount }}">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-1">
                                                                            <button type="button" name="button"
                                                                                    class="btn btn-default btn-circle m-t-2 {% if loop.index0 %}remove_price{% else %}add_price{% endif %}">
                                                                                <i class="fa {% if loop.index0 %}fa-minus{% else %}fa-plus{% endif %}"></i>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- </div> -->
                                                </div>
                                            {% endfor %}
                                            {% if tickets | length == 0 %}
                                                <div class="form-group add-ticket ticket_group" id="ticket_1">
                                                    <!-- <label class="col-sm-2 control-label">Ticket 1</label> -->
                                                    <!-- <div class="col-sm-10"> -->
                                                    <div class="row col-sm-10 col-md-offset-1">
                                                        <div class="col-md-9 padding-control">
                                                            <input class="form-control required ticket-title"
                                                                   name="ticket_title_1" data-ticket-id=""
                                                                   placeholder="Ticket title" type="text">
                                                        </div>
                                                        <div class="col-md-1 button-align-padding">
                                                            <button class="btn btn-default btn-circle" type="button"
                                                                    data-ticket-id="" data-toggle="collapse"
                                                                    data-target="#ticket_collapse_1"><i
                                                                    class="fa fa-gear"></i></button>
                                                        </div>
                                                        <div class="col-md-1 button-align-padding">
                                                            <button style="display: none"
                                                                    class="btn btn-default btn-circle status unconceal"
                                                                    type="button" data-ticket-id=""><i
                                                                    class="fa fa-eye"></i></button>
                                                        </div>
                                                        <div class="col-md-1 button-align-padding">
                                                            <!-- for delete icon -->
                                                            <button class="btn btn-default btn-circle btn-outline remove"
                                                                    type="button" data-ticket-id=""><i
                                                                    class="fa fa-trash"></i></button>
                                                        </div>
                                                        <div id="ticket_collapse_1" class="collapse col-md-12 in">
                                                            <div style="padding: 15px 20px 20px 20px">
                                                                <div class="form-group">
                                                                    <div class="col-md-3 control-label">
                                                                        <!-- <label for="date">Start date and end date</label> -->
                                                                        <p>Start date and end date</p>
                                                                    </div>
                                                                    <div class="col-md-7 col-md-offset-2">
                                                                        <div class="input-daterange input-group col-md-7"
                                                                             style="width: 100%;">
                                                                            <input type="text"
                                                                                   class="input-sm form-control required"
                                                                                   name="start">
                                                                            <span class="input-group-addon control-height">to</span>
                                                                            <input type="text"
                                                                                   class="input-sm form-control required"
                                                                                   name="end">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <div class="col-md-3 control-label">
                                                                        <!-- <label for="date">Start date and end date</label> -->
                                                                        <p>Price</p>
                                                                    </div>
                                                                    <div class="col-md-6 col-md-offset-2">
                                                                        <div class="input-group price_group">
                                                                            <div class="input-group-btn">
                                                                                <select class="form-control currency" style="width: 100px;">
                                                                                    {% for currency in currency_list %}
                                                                                        <option value="{{ currency }}">{{ currency }}</option>
                                                                                    {% endfor %}
                                                                                </select>
                                                                            </div>
                                                                            <input type="number"
                                                                                   class="form-control required"
                                                                                   name="price">
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-1">
                                                                        <button type="button" name="button"
                                                                                class="btn btn-default btn-circle m-t-2 add_price">
                                                                            <i class="fa fa-plus"></i>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- </div> -->
                                                </div>
                                            {% endif %}
                                        </div>
                                        <div class="add-ticket-button-control row col-md-offset-9">
                                            <button id="addTicket" class="btn btn-sm btn-primary m-t-n-xs"><i
                                                    class="fa fa-plus"></i> Add
                                            </button>
                                        </div>
                                        <div class="form-group col-sm-offset-5 col-md-offset-5 col-lg-offset-5">
                                            <button id="confirm-button" class="btn btn-primary center-block">
                                                Confirm
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div id="product" class="tab-pane {% if endpoint == 'registration_products' %}active{% endif %}">
                        <div class="panel-body">
                            <div class="col-md-12 row">
                                <p class="para-button-align">Add or update products, such as guest ticket, tour pass, gift, etc.</p>
                                <div class="div-button-align">
                                    <button type="button" class="btn btn-primary pull-right button-para-align" data-toggle="modal" data-target="#productModal" data-action="new_product">Add Products</button>
                                </div>
                                <div class="hr-line-dashed"></div>
                                {% for product in conference.registration.products.all() if product.status != 'Deleted' %}
                                <div class="panel panel-default" data-product-id="{{ product.id }}">
                                    <div class="panel-heading" style="min-height: 40px; padding-top: 5px; padding-bottom: 5px;">
                                        <h5 data-product-name="{{ product.name }}">{{ product.name }}</h5>
                                        <div class="ibox-tools">
                                            <span class="btn glyphicon glyphicon-eye-{% if product.status == 'Normal' %}close{% else %}open{% endif %}" onclick="update_product_statue(this)" title="{% if product.status == 'Normal' %}Hide{% else %}Show{% endif %} this product" data-product-status="{{ product.status }}"></span>
                                            <span class="btn glyphicon glyphicon-edit" title="Edit product" data-toggle="modal" data-target="#productModal" data-action="edit_product"></span>
                                            <span class="btn glyphicon glyphicon-trash" title="Delete product" data-action="delete_product" {% if product | product_has_sold %}disabled{% else %}onclick="delete_product(this)"{% endif %}></span>
                                        </div>
                                    </div>
                                    <div class="panel-body" style="border: none;">
                                        <div class="form-group">
                                            <label class="col-sm-1 control-label">Price: </label>
                                            <div class="col-sm-11">
                                                <label class="product_price" data-product-price="{{ product.price }}" data-product-currency="{{ product.currency }}">{% if product.price %}{{ product.price }} {{ product.currency }}{% else %}N/A{% endif %}</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-1 control-label">Inventory: </label>
                                            <div class="col-sm-11">
                                                <label class="product_inventory" data-product-inventory="{{ product.inventory }}">{% if product.inventory != -1 %}{{ product.inventory }}{% else %}Unlimited{% endif %}</label>
                                            </div>
                                        </div>
                                        {% set options = product.options.filter_by(default=False).all() %}
                                        {% if options | length %}
                                            <div class="form-group">
                                                <label class="col-sm-1 control-label">Options: </label>
                                                <div class="col-sm-11">
                                                    <label>{% for option in options %}<code data-option-id="{{ option.id }}" data-option-name="{{ option.option_name }}" data-option-price="{{ option.option_price }}">{{ option.option_name }}({{option.option_price}} {{ product.currency }})</code>{% if not loop.last %}, {% endif %}{% endfor %}</label>
                                                </div>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div id="promo" class="tab-pane  {% if endpoint == 'registration_promo_code' %}active{% endif %}">
                        <div class="panel-body">
                            <p class="para-button-align">You can offer your attendees a monetary, percentage discounts
                                on tickets in your conference.</p>
                            <div class="div-button-align">
                                <button type="button" class="btn btn-primary pull-right button-para-align"
                                        data-toggle="modal" data-target="#promoCodeForm" data-action="new_promo_code">Add
                                    Promo Codes
                                </button>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="ibox">
                                <div class="project-list">
                                    <table class="table table-hover">
                                        <tbody class="promo-codes-list">
                                        {% for promo_code in conference.registration.promo_codes.all() %}
                                            <tr id="promo_{{ loop.index }}">
                                                <input type="hidden" class="promo-type" value="{{ promo_code.type }}">
                                                <td class="project-status">
                                                    <span class="label {% if promo_code.status == 'Active' %}label-primary{% else %}label-default{% endif %}">{{ promo_code.status }}</span>
                                                </td>
                                                <td class="project-title">
                                                    <div class="promo-code">{{ promo_code.promo_code }}</div>
                                                    <br/>
                                                    <small data-promo-code-value="{{ promo_code.value }}">
                                                        {% if promo_code.type == 'fixed_amount' %}{{ promo_code.value }}{% else %}{{ promo_code.value }}%{% endif %} off
                                                    </small>
                                                    <small data-promo-code-currency="{{ promo_code.currency }}">
                                                        - only works on {{ promo_code.currency }}
                                                    </small>
                                                </td>
                                                <td class="project-completion">
                                                    {% if promo_code.quantity != -1 %}
                                                        <small data-promo-code-usage="{{ promo_code.usage }}"
                                                               data-promo-code-quantity="{{ promo_code.quantity }}">{{ promo_code.usage }}
                                                            / {{ promo_code.quantity }}</small>
                                                    {% else %}
                                                        <small data-promo-code-usage="{{ promo_code.usage }}"
                                                               data-promo-code-quantity="{{ promo_code.quantity }}">{{ promo_code.usage }}
                                                            / Unlimited
                                                        </small>
                                                    {% endif %}
                                                    <div class="progress progress-mini">
                                                        <div style="width:{% if promo_code.quantity != -1 %}{{ 100*promo_code.usage/promo_code.quantity }}{% else %}0{% endif %}%;"
                                                             class="progress-bar"></div>
                                                    </div>
                                                </td>
                                                <td class="project-people">
                                                    <div data-promo-code-start-date="{{ promo_code.start_date|string }}"
                                                         data-promo-code-end-date="{{ promo_code.end_date|string }}">
                                                        {{ promo_code.start_date|string }}
                                                        ~ {{ promo_code.end_date|string }}
                                                    </div>
                                                </td>
                                                <td class="project-actions">
                                                    <button class="btn btn-white btn-sm promo-status"
                                                            data-promo-code-id="{{ promo_code.id }}"
                                                            data-action="{% if promo_code.status == 'Active' %}disable{% else %}enable{% endif %}">
                                                        {% if promo_code.status == 'Active' %}Disable{% else %}Enable{% endif %}
                                                    </button>
                                                    <button class="btn btn-white btn-sm promo-edit"
                                                            data-promo-code-id="{{ promo_code.id }}" data-toggle="modal"
                                                            data-target="#promoCodeForm" data-action="promo_code_edit"><i
                                                            class="fa fa-pencil"></i> Edit
                                                    </button>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>
  <div id="price_template" style="display:none">
      <div class="form-group">
          <div class="col-md-6 col-md-offset-5">
              <div class="input-group price_group">
                  <div class="input-group-btn">
                      <select class="form-control currency" name="" style="width: 100px;">
                            {% for currency in currency_list %}
                                <option value="{{ currency }}">{{ currency }}</option>
                            {% endfor %}
                      </select>
                  </div>
                  <input type="number" class="form-control required" name="price">
              </div>
          </div>
          <div class="col-md-1">
              <button type="button" name="button" class="btn btn-default btn-circle m-t-2 remove_price">
                  <i class="fa fa-minus"></i>
              </button>
          </div>
      </div>
  </div>
    <div id="ticket_template" style="display:none">
        <div class="form-group" id="">
            <!-- <label class="col-sm-2 control-label">Ticket 1</label> -->
            <!-- <div class="col-sm-10"> -->
            <div class="row col-sm-10 col-md-offset-1">
                <div class="col-md-9 padding-control">
                    <input class="form-control required ticket-title" name="" data-ticket-id=""
                           placeholder="Ticket title" type="text" value="" aria-required="true">
                </div>
                <div class="col-md-1 button-align-padding">
                    <button class="btn btn-default btn-circle setting" type="button" data-ticket-id=""
                            data-toggle="collapse" data-target=""><i class="fa fa-gear"></i></button>
                </div>
                <div class="col-md-1 button-align-padding">
                    <button class="btn btn-default btn-circle status unconceal" type="button" disabled
                            data-ticket-id=""><i class="fa fa-eye"></i></button>
                </div>
                <div class="col-md-1 button-align-padding">
                    <button class="btn btn-default btn-circle btn-outline remove" type="button" data-ticket-id=""><i
                            class="fa fa-trash"></i></button>
                </div>
                <div id="" class="collapse col-md-12 in">
                    <div style="padding: 15px 20px 20px 20px">
                        <div class="form-group">
                            <div class="col-md-3 control-label">
                                <p>Start date and end date</p>
                            </div>
                            <div class="col-md-7 col-md-offset-2">
                                <div class="input-daterange input-group col-md-7" style="width: 100%;">
                                    <input type="text" class="input-sm form-control required" name="start" value="">
                                    <span class="input-group-addon control-height">to</span>
                                    <input type="text" class="input-sm form-control required" name="end" value="">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-3 control-label">
                                <!-- <label for="date">Start date and end date</label> -->
                                <p>Price</p>
                            </div>
                            <div class="col-md-6 col-md-offset-2">
                                <div class="input-group price_group">
                                    <div class="input-group-btn">
                                        <select class="form-control currency" name="" style="width: 100px;">
                                            {% for currency in currency_list %}
                                                <option value="{{ currency }}">{{ currency }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <input type="number" class="form-control positive_number" name="price">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <button type="button" name="button" class="btn btn-default btn-circle m-t-2 add_price">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- </div> -->
    </div>
    <div class="modal fade" id="promoCodeForm" tabindex="-1" role="dialog" aria-labelledby="promoCodeFormLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title" id="promoCodeFormLabel" style="padding-left:15px">Add Promo Codes</h2>
                </div>
                <div class="modal-body">
                    <form id="modal-form">
                        <input type="hidden" id="promo_code_id" value="">
                        <div class="form-group">
                            <label for="promo-code" class="control-label">Promo Code</label>
                            <input type="text" class="form-control required" id="promo-code"
                                   placeholder="e.g 50DISCOUNT"/>
                            <p class="text-primary">Attendees will enter this code at registration.</p>
                        </div>
                        <div class="form-group">
                            <label for="promo-type" class="control-label">Conditions</label>
                            <p>Select the currency that the promo code will support, then select promo code type.</p>
                            <div class="row">
                                <div class="col-md-3">
                                    <select class="form-control" id="promo-currency" name="promo-currency">
                                        {% for currency in currency_list %}
                                        <option value="{{ currency }}">{{ currency }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <select class="form-control" id="promo-type" name="promo-type">
                                        <option value="fixed_amount">Amount Discount</option>
                                        <option value="percentage">% Discount</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <span for="promo-value" class="col-sm-3 span-align-padding text-center">take</span>
                                    <div class="col-sm-6">
                                        <input type="number" name="promo-value" id="promo-value" placeholder=""
                                               class="form-control positive_number" min="0">
                                    </div>
                                    <span class="col-sm-3 span-align-padding text-center">off</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="usage-limit" class="control-label">Usage Limits</label>
                            <p class="margin-button-5">Total quantity available</p>
                            <div>
                                <label>
                                    <input type="radio" name="usage_limit_type" id="usage_limit_type_no_limit"
                                           onclick="radio_checked(this)" value="-1" checked=""> Unlimited
                                </label>
                            </div>
                            <div>
                                <label>
                                    <input type="radio" name="usage_limit_type" id="usage_limit_type_with_limit"
                                           value="" onclick="radio_checked(this)">
                                    <input name="quantity" onkeyup="usage_limit(this)" min="1" step="1" type="number"
                                           pattern="\d*" placeholder="Required if checked" disabled>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Date Range</label>
                            <div class="input-daterange input-group" id="modal-date-daterange" style="width: 100%;">
                                <input type="text" class="form-control required" id="promo-start" name="promo-start"/>
                                <span class="input-group-addon">to</span>
                                <input type="text" class="form-control required" id="promo-end" name="promo-end"/>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="save-new-promo-code">Save</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="productModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title" id="productModalLabel" style="padding-left:15px">Add Products</h2>
                </div>
                <div class="modal-body">
                    <form id="product-modal-form" class="modal-form" action="{{ url_for('conference.registration_products', conference_id=conference.id) }}" method="post">
                        <input type="hidden" id="_method" name="_method" value=""/>
                        <input type="hidden" id="product_id" name="product_id" value="">
                        <div class="form-group">
                            <label for="product_name" class="control-label">Name</label><span style="color:#ed5565"> *</span>
                            <input type="text" class="form-control required" id="product_name" name="product_name"/>
                        </div>
                        <label for="product_name" class="control-label">Price</label><span style="color:#ed5565"> *</span>
                        <div class="form-inline">
                            <div class="form-group">
                                <select class="form-control currency" name="product_currency" id="product_currency" style="width: 100px;">
                                    {% for currency in currency_list %}
                                        <option value="{{ currency }}">{{ currency }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <input type="number" min="0" class="form-control check_price" id="product_price" name="product_price"/>
                            </div>
                        </div>
                        <!-- <div class="form-inline">

                        </div>
                        <div class="form-inline">
                            <div class="form-group">
                                <input type="text" class="form-control check_price" id="product_price" name="product_price"/>
                            </div>
                        </div> -->
                        <div class="form-group">
                            <label for="options" class="control-label">Options</label> &nbsp;<i class="fa fa-question-circle" id="tips" data-toggle="tooltip" data-placement="top" title="Each option has its own name and price"></i>
                            <ul id="product_options_list" class="form-inline" style="list-style-type: none; padding-left: 15px;">
                            </ul>
                            <button type="button" class="btn btn-default btn-sm" onclick="add_product_option(this)"><i class="fa fa-plus-circle"></i> Add option</button>
                        </div>
                        <div class="form-group">
                            <label for="usage-limit" class="control-label">Inventory</label><span style="color:#ed5565"> *</span>
                            <br>
                            <label class="radio-inline">
                                <input type="radio" name="product_inventory" id="usage_limit_type_no_limit" value="-1" checked=""> Unlimited
                            </label>
                            <label class="radio-inline margin-top-6">
                                <input type="radio" name="product_inventory" id="usage_limit_type_with_limit" value="">
                                <input name="inventory" class="positive_number" onclick="this.previousSibling.previousSibling.checked=true;" onchange="usage_limit(this)" min="1" step="1" type="number" pattern="\d*"/ value="1">
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" form="product-modal-form" class="btn btn-primary" id="save-model-form">Save</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    {{ super() }}
    <script>
        var conferenceID = "{{ conference.id }}";
        var numTickets = {% if conference.registration.tickets.all() | length == 0 %}1{% else %}{{ conference.registration.tickets.all() | length }}{% endif %};  // special case number of tickets is 1
        var conferenceEndDate = "{{conference.end_date|date}}";

        var endpoints = {
            addTickets: "{{ url_for('api.add_tickets', id=conference.id) }}",
            updateTickets: "{{ url_for('api.update_tickets', id=conference.id) }}",
            deleteTickets: "{{ url_for('api.delete_tickets', id=conference.id) }}",
            addPromoCode: "{{ url_for('api.add_promo_code', registration_id=conference.registration.id) }}",
            updatePromoCode: "{{ url_for('api.update_promo_code', registration_id=conference.registration.id) }}",
            updateProduct: "{{ url_for('api.update_product', id='0') }}",
            deleteProduct: "{{ url_for('api.delete_products', conference_id=conference.id) }}"
        }
    </script>
    <!-- Jquery Validate -->
    <script src="{{ url_for('static', filename='inspinia/js/plugins/validate/jquery.validate.min.js') }}"></script>
    <!-- datepicker -->
    <script src="{{ url_for('static', filename='conferency/js/bootstrap-datepicker.js') }}"></script>
    <!-- Switchery -->
    <script src="{{ url_for('static', filename='inspinia/js/plugins/switchery/switchery.js') }}"></script>
    <!-- Clipboard -->
    <script src="{{ url_for('static', filename='conferency/js/clipboard.min.js') }}"></script>
    <!-- Page specific js -->
    <script src="{{ url_for('static', filename='conferency/js/registration_tickets.js') }}"></script>
    <!-- custom question -->
    <script src="{{ url_for('static', filename='conferency/js/custom_question.js') }}" type="text/javascript"></script>
    <!-- products -->
    <script src="{{ url_for('static', filename='conferency/js/registration.products.js') }}" type="text/javascript"></script>
{% endblock %}
